<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Experiments</title>
    <link rel="icon" href="animatedfavicon.ico" type="image/x-icon">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        /* Default light mode styles */
        body {
            background-color: #f5f5f5;
            color: #333;
            font-family: Arial, sans-serif;
            transition: background-color 0.3s, color 0.3s;
            margin: 0;
            padding: 10px;
        }

        a {
            color: blue;
            text-decoration: none;
        }

        a:hover {
            color: darkblue;
        }

        body.dark-mode {
            background-color: #121212;
            color: #e0e0e0;
        }

        body.dark-mode a {
            color: #80d8ff;
        }

        body.dark-mode a:hover {
            color: #40c4ff;
        }

        .dark-mode-toggle {
            cursor: pointer;
            text-decoration: underline;
            color: blue;
            display: block;
            margin-top: 10px;
            margin-bottom: 20px;
        }

        body.dark-mode .dark-mode-toggle {
            color: #80d8ff;
        }

        h1 {
            font-size: 2em;
            margin-bottom: 0.5em;
        }

        p {
            font-size: 1.2em;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <!-- Main title and navigation -->
    <h1>Experiments</h1>
    <a href="index.html">Back to Home</a>
    <span class="dark-mode-toggle" onclick="toggleDarkMode()">Click here to activate dark mode</span>
    
    <!-- Small text note -->
    <p>Made in an evening with ChatGPT</p>

    <!-- Processing.js sketch embedded -->
    <script>
        let numSegments = 17; 
        let stickLength = 150;
        let segments = [];
        let segmentLengths = [];
        let gravity = 1.0; 
        let windStrength = 0.12; 
        let segmentColor;
        let windIntensity;
        let windRange = 2.0; 
        let windDirectionAngle;
        let windSpeeds = [];
        let windOffset;

        function setup() {
            createCanvas(800, 600);
            frameRate(60);
            textSize(12);
            fill(200);

            segmentColor = color(255, 165, 0);
            for (let i = 0; i < numSegments; i++) {
                segmentLengths[i] = map(i, 0, numSegments - 1, 17, 6);
            }
            segments[0] = createVector(width / 2, height * 2 / 3 - stickLength);
            for (let i = 1; i <= numSegments; i++) {
                segments[i] = createVector(segments[i - 1].x, segments[i - 1].y + segmentLengths[i - 1]);
            }
            windOffset = random(1000);
        }

        function draw() {
            background(0);
            applyPhysics();
            displaySegments();
            displayWindSpeed();
            displayWindDirection();
        }

        function applyPhysics() {
            windIntensity = noise(frameCount * 0.01) * windRange;
            windSpeeds.push(windIntensity);
            if (windSpeeds.length > 60) {
                windSpeeds.shift();
            }

            let windDirection = (noise(windOffset + frameCount * 0.01) - 0.5) * (1 / (1 + windIntensity));
            windDirectionAngle = windDirection * PI / 4;
            let windX = cos(windDirectionAngle) * windIntensity * windStrength;
            let windY = sin(windDirectionAngle) * windIntensity * windStrength;

            for (let i = 1; i <= numSegments; i++) {
                segments[i].y += gravity + windY;
                segments[i].x += windX * segmentLengths[i - 1];

                let dir = p5.Vector.sub(segments[i], segments[i - 1]);
                dir.setMag(segmentLengths[i - 1]);
                segments[i] = p5.Vector.add(segments[i - 1], dir);
            }
        }

        function displaySegments() {
            stroke(255);
            strokeWeight(4);
            line(segments[0].x, segments[0].y + stickLength, segments[0].x, segments[0].y);

            for (let i = 1; i < numSegments; i++) {
                stroke(segmentColor);
                strokeWeight(2);
                line(segments[i].x, segments[i].y, segments[i + 1].x, segments[i + 1].y);
            }
        }

        function displayWindSpeed() {
            let avgWindSpeed = windSpeeds.reduce((a, b) => a + b, 0) / windSpeeds.length;
            let windSpeedKnots = windIntensity * 1.94384;
            let avgWindSpeedKnots = avgWindSpeed * 1.94384;
            let windSpeedMph = windIntensity * 2.23694;
            let avgWindSpeedMph = avgWindSpeed * 2.23694;

            textAlign(CENTER);
            text(`Current Wind Speed: ${nf(windSpeedKnots, 1, 2)} knots (${nf(windSpeedMph, 1, 2)} mph)`, width / 2, segments[0].y - 90);
            text(`Average Wind Speed: ${nf(avgWindSpeedKnots, 1, 2)} knots (${nf(avgWindSpeedMph, 1, 2)} mph)`, width / 2, segments[0].y - 70);
        }

        function displayWindDirection() {
            push();
            translate(50, 50);
            rotate(windDirectionAngle);
            stroke(200);
            strokeWeight(3);
            let arrowLength = 30 + windIntensity * 20;
            line(0, 0, arrowLength, 0);
            line(arrowLength, 0, arrowLength - 5, -5);
            line(arrowLength, 0, arrowLength - 5, 5);
            pop();
        }

        function keyPressed() {
            if (keyCode === UP_ARROW) {
                windRange += 0.1;
            } else if (keyCode === DOWN_ARROW) {
                windRange = max(0, windRange - 0.1);
            }

            if (key === 'E') {
                gravity += 0.1;
            } else if (key === 'D') {
                gravity = max(0, gravity - 0.1);
            }
        }
    </script>

    <!-- Dark mode functionality -->
    <script src="scripts/darkmode.js"></script>
</body>
</html>
